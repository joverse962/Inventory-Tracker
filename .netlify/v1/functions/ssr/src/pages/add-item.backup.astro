---
import BaseLayout from '../layouts/BaseLayout.astro';
---
<BaseLayout>
  <div class="max-w-2xl mx-auto">
    <h2 class="text-3xl font-bold mb-6">âž• Add New Item</h2>
    
    <div class="bg-white p-8 rounded-lg shadow-lg">
      <form class="space-y-6" x-data="{ 
        hasComponents: false, 
        components: [],
        addComponent() {
          this.components.push({ name: '', quantity: 1 });
        },
        removeComponent(index) {
          this.components.splice(index, 1);
        }
      }">
        <!-- Item Name -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">
            Item Name *
          </label>
          <input 
            type="text" 
            name="name"
            placeholder="e.g., Dell Laptop XPS 15" 
            class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
            required
          />
        </div>

        <!-- Photo Upload -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">
            Item Photo
          </label>
          <div class="flex items-center gap-4">
            <input 
              type="file" 
              name="photo"
              accept="image/*"
              class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
            />
            <button type="button" class="px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 whitespace-nowrap">
              ðŸ“· Take Photo
            </button>
          </div>
        </div>

        <!-- Description -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">
            Description
          </label>
          <textarea 
            name="description"
            placeholder="Detailed description of the item..."
            rows="4"
            class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
          ></textarea>
        </div>

        <!-- Location -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">
            Location *
          </label>
          <select 
            name="location"
            class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
            required
          >
            <option value="">Select location...</option>
            <option value="Warehouse A">Warehouse A</option>
            <option value="Warehouse B">Warehouse B</option>
            <option value="Office Floor 1">Office Floor 1</option>
            <option value="Office Floor 2">Office Floor 2</option>
          </select>
        </div>

        <!-- Category -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">
            Category *
          </label>
          <select 
            name="category"
            class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
            required
          >
            <option value="">Select category...</option>
            <option value="Electronics">Electronics</option>
            <option value="Furniture">Furniture</option>
            <option value="Office Supplies">Office Supplies</option>
            <option value="Tools">Tools</option>
          </select>
        </div>

        <!-- Initial Status -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">
            Initial Status *
          </label>
          <select 
            name="status"
            class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
            required
          >
            <option value="available">âœ… Available</option>
            <option value="used">ðŸ”§ Used</option>
          </select>
        </div>

        <!-- Has Components Toggle -->
        <div>
          <label class="flex items-center gap-2 cursor-pointer">
            <input 
              type="checkbox" 
              x-model="hasComponents"
              class="w-4 h-4 text-blue-600 rounded focus:ring-blue-500"
            />
            <span class="text-sm font-medium text-gray-700">
              This item has components/accessories
            </span>
          </label>
        </div>

        <!-- Components Section -->
        <div x-show="hasComponents" class="border-t pt-6" style="display: none;">
          <div class="flex justify-between items-center mb-4">
            <h3 class="text-lg font-semibold">Components/Accessories</h3>
            <button 
              type="button"
              @click="addComponent()"
              class="px-3 py-1 bg-blue-500 text-white text-sm rounded hover:bg-blue-600"
            >
              + Add Component
            </button>
          </div>

          <div class="space-y-3">
            <template x-for="(component, index) in components" :key="index">
              <div class="flex gap-2 items-center">
                <input 
                  type="text" 
                  :name="'component_name_' + index"
                  placeholder="Component name"
                  class="flex-1 px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                />
                <input 
                  type="number" 
                  :name="'component_qty_' + index"
                  placeholder="Qty"
                  min="1"
                  value="1"
                  class="w-20 px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                />
                <button 
                  type="button"
                  @click="removeComponent(index)"
                  class="px-3 py-2 bg-red-500 text-white rounded hover:bg-red-600"
                >
                  âœ•
                </button>
              </div>
            </template>

            <div x-show="components.length === 0" class="text-gray-500 text-sm text-center py-4">
              No components added yet. Click "Add Component" to add one.
            </div>
          </div>
        </div>

        <!-- Submit Buttons -->
        <div class="flex gap-3 pt-6 border-t">
          <button 
            type="submit"
            class="flex-1 bg-blue-500 text-white px-6 py-3 rounded-lg hover:bg-blue-600 transition font-semibold"
          >
            âœ“ Add Item
          </button>
          <button 
            type="button"
            onclick="window.location.href='/'"
            class="px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition"
          >
            Cancel
          </button>
        </div>
      </form>
    </div>

    <!-- Quick Tips -->
    <div class="mt-6 bg-blue-50 p-4 rounded-lg">
      <h4 class="font-semibold text-blue-900 mb-2">ðŸ’¡ Tips:</h4>
      <ul class="text-sm text-blue-800 space-y-1">
        <li>â€¢ Take clear photos for easy identification</li>
        <li>â€¢ Include all accessories as components for complete tracking</li>
        <li>â€¢ Use descriptive names for better searchability</li>
        <li>â€¢ Set the correct location to make items easier to find</li>
      </ul>
    </div>
  </div>
</BaseLayout>
